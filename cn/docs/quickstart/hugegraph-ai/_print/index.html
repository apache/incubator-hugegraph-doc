<!doctype html><html lang=cn class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=content-security-policy content="script-src 'self'; script-src-elem 'self' https://code.jquery.com https://cdn.jsdelivr.net https://fonts.googleapis.com;"><meta name=generator content="Hugo 0.102.3"><link rel=canonical type=text/html href=/cn/docs/quickstart/hugegraph-ai/><link rel=alternate type=application/rss+xml href=/cn/docs/quickstart/hugegraph-ai/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>HugeGraph-AI | HugeGraph</title><meta name=description content="
请参阅 AI 仓库的 README 以获取最新的文档，官网会定期更新同步。


AI 总结项目文档：

1. 摘要
hugegraph-llm 是一个用于实现和研究大语言模型相关功能的工具。
该项目包含可运行的演示（demo），也可以作为第三方库使用。
众所周知，图系统可以帮助大模型解决时效性和幻 …"><meta property="og:title" content="HugeGraph-AI"><meta property="og:description" content="Apache HugeGraph 官网"><meta property="og:type" content="website"><meta property="og:url" content="/cn/docs/quickstart/hugegraph-ai/"><meta property="og:site_name" content="HugeGraph"><meta itemprop=name content="HugeGraph-AI"><meta itemprop=description content="Apache HugeGraph 官网"><meta name=twitter:card content="summary"><meta name=twitter:title content="HugeGraph-AI"><meta name=twitter:description content="Apache HugeGraph 官网"><link rel=preload href=/scss/main.min.14ea575cb35d93d46ff8681b2334f40fd46243c100c5c39f5a841b931fae2d40.css as=style><link href=/scss/main.min.14ea575cb35d93d46ff8681b2334f40fd46243c100c5c39f5a841b931fae2d40.css rel=stylesheet integrity><script src=/js/jquery.min.js></script>
<link rel=stylesheet href=/css/prism.css></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/cn/><span class=navbar-logo><svg id="图层_1" data-name="图层 1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 16 16"><defs><style>.logo-cls-1{fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:.5px;opacity:.3}.logo-cls-2{fill:#229efa}.logo-cls-3{fill:#9948f7}.logo-cls-4{fill:#33bc7a}.logo-cls-5{fill:url(#未命名的渐变_3)}.logo-cls-6{fill:url(#未命名的渐变_13)}.logo-cls-7{fill:url(#未命名的渐变_11)}</style><linearGradient id="未命名的渐变_3" x1="6.16" y1="14.63" x2="6.16" y2="6.01" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#2e3192"/><stop offset="0" stop-color="#229efa"/><stop offset=".44" stop-color="#239cf8"/><stop offset=".6" stop-color="#2795f2"/><stop offset=".71" stop-color="#2d8ae8"/><stop offset=".81" stop-color="#3679d9"/><stop offset=".89" stop-color="#4263c6"/><stop offset=".95" stop-color="#5048af"/><stop offset="1" stop-color="#5c319b"/></linearGradient><linearGradient id="未命名的渐变_13" x1="10.75" y1="8.2" x2="4.49" y2="1.94" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#991146"/><stop offset="0" stop-color="#326b4e"/><stop offset=".02" stop-color="#3a685c"/><stop offset=".07" stop-color="#506180"/><stop offset=".13" stop-color="#645aa0"/><stop offset=".19" stop-color="#7554bc"/><stop offset=".26" stop-color="#8250d2"/><stop offset=".35" stop-color="#8d4ce3"/><stop offset=".45" stop-color="#944aee"/><stop offset=".6" stop-color="#9848f5"/><stop offset="1" stop-color="#9948f7"/></linearGradient><linearGradient id="未命名的渐变_11" x1="15.34" y1="6.67" x2="7.88" y2="10.98" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#33bc7a"/><stop offset=".45" stop-color="#32ba7a"/><stop offset=".61" stop-color="#2fb37c"/><stop offset=".73" stop-color="#29a87e"/><stop offset=".82" stop-color="#219782"/><stop offset=".9" stop-color="#168186"/><stop offset=".97" stop-color="#09668b"/><stop offset="1" stop-color="#03598e"/></linearGradient></defs><title>logo</title><rect class="logo-cls-1" x="-143.14" y="-373.46" width="597.8" height="424.44"/><circle class="logo-cls-2" cx="12.02" cy="1.83" r="1.33"/><circle class="logo-cls-3" cx="12.02" cy="14.17" r="1.33"/><circle class="logo-cls-4" cx="1.33" cy="8" r="1.33"/><path class="logo-cls-5" d="M7.91 10h0a2.65 2.65.0 01-.23-3.74A1.75 1.75.0 017.91 6h0A2.66 2.66.0 014.4 6h0a1.81 1.81.0 01.24.24A2.65 2.65.0 014.4 10h0a2.62 2.62.0 00-.89 2 2.65 2.65.0 104.4-2z"/><path class="logo-cls-6" d="M12.19 5.49a2.78 2.78.0 01-.5.11A2.64 2.64.0 018.76 3.5h0a2.65 2.65.0 10-2.6 3.17A2.6 2.6.0 007 6.53H7a2.65 2.65.0 013.44 2 2.94 2.94.0 010-.51 2.65 2.65.0 011.75-2.53z"/><path class="logo-cls-7" d="M13 5.35a2.64 2.64.0 00-2.59 2.12h0a3 3 0 01-.08.32A2.65 2.65.0 017.54 9.58a2.86 2.86.0 00.37.41h0a2.63 2.63.0 01.9 2 2.84 2.84.0 01-.05.51 2.64 2.64.0 013.12-2.06l.32.08h0a2.6 2.6.0 00.84.14 2.65 2.65.0 100-5.3z"/></svg></span><span class=font-weight-bold>HugeGraph</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/cn/docs/><i class='fas fa-book pr-2'></i><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/apache/incubator-hugegraph target=_blank><i class='fab fa-github pr-2'></i><span>GitHub</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/cn/docs/download/download/><i class='fas fa-download pr-2'></i><span>Download</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/cn/community/><span>Community</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>中文</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/quickstart/hugegraph-ai/>English</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/cn/docs/quickstart/hugegraph-ai/>Return to the regular view of this page</a>.</p></div><h1 class=title>HugeGraph-AI</h1><ul><li>1: <a href=#pg-bb10fc095f5061d789104547f7246a67>GraphRAG UI Details</a></li></ul><div class=content><blockquote><p>请参阅 AI 仓库的 <a href=https://github.com/apache/incubator-hugegraph-ai/tree/main/hugegraph-llm#readme>README</a> 以获取最新的文档，官网会<strong>定期</strong>更新同步。</p></blockquote><blockquote><p>AI 总结项目文档：<a href=https://deepwiki.com/apache/incubator-hugegraph-ai><img src=https://deepwiki.com/badge.svg alt="Ask DeepWiki"></a></p></blockquote><h2 id=1-摘要>1. 摘要</h2><p><code>hugegraph-llm</code> 是一个用于实现和研究大语言模型相关功能的工具。
该项目包含可运行的演示（demo），也可以作为第三方库使用。</p><p>众所周知，图系统可以帮助大模型解决时效性和幻觉等挑战，
而大模型则可以帮助图系统解决成本相关的问题。</p><p>通过这个项目，我们旨在降低图系统的使用成本，并减少构建知识图谱的复杂性。
本项目将为图系统和大语言模型提供更多的应用和集成解决方案。</p><ol><li>通过 LLM + HugeGraph 构建知识图谱</li><li>使用自然语言操作图数据库 (Gremlin/Cypher)</li><li>知识图谱补充答案上下文 (GraphRAG → Graph Agent)</li></ol><h2 id=2-环境要求>2. 环境要求</h2><blockquote><p>[!IMPORTANT]</p><ul><li>python 3.10+ (未在 3.12 中测试)</li><li>hugegraph-server 1.3+ (建议使用 1.5+)</li><li>uv 0.7+</li></ul></blockquote><h2 id=3-准备工作>3. 准备工作</h2><h3 id=31-docker>3.1 Docker</h3><p><strong>Docker 部署</strong>  
   您也可以使用 Docker 来部署 HugeGraph-AI：
   - 确保您已安装 Docker
   - 我们提供两个容器镜像：
     - <strong>镜像 1</strong>: <a href=https://hub.docker.com/r/hugegraph/rag/tags>hugegraph/rag</a>  
       用于构建和运行 RAG 功能，适合快速部署和直接修改源码
     - <strong>镜像 2</strong>: <a href=https://hub.docker.com/r/hugegraph/rag-bin/tags>hugegraph/rag-bin</a>  
       使用 Nuitka 编译的 C 二进制转译版本，性能更好、更高效
   - 拉取 Docker 镜像：
     <code>bash      docker pull hugegraph/rag:latest # 拉取镜像1      docker pull hugegraph/rag-bin:latest # 拉取镜像2      </code>
   - 启动 Docker 容器：
     <code>bash      docker run -it --name rag -v /path/to/.env:/home/work/hugegraph-llm/.env -p 8001:8001 hugegraph/rag bash      docker run -it --name rag-bin -v /path/to/.env:/home/work/hugegraph-llm/.env -p 8001:8001 hugegraph/rag-bin bash      </code>
   - 启动 Graph RAG 演示：
     ```bash
     # 针对镜像 1
     python ./src/hugegraph_llm/demo/rag_demo/app.py # 或运行 python -m hugegraph_llm.demo.rag_demo.app</p><p>     # 针对镜像 2
     ./app.dist/app.bin
     ```
   - 访问接口 http://localhost:8001</p><h3 id=32-从源码构建>3.2 从源码构建</h3><ol><li><p>启动 HugeGraph 数据库，您可以通过 <a href=https://hub.docker.com/r/hugegraph/hugegraph>Docker</a>/<a href=https://hugegraph.apache.org/docs/download/download/>二进制包</a> 运行它。
    有一个使用 docker 的简单方法：  
    <code>bash    docker run -itd --name=server -p 8080:8080 hugegraph/hugegraph    </code>  
   更多指引请参阅详细文档 <a href=/docs/quickstart/hugegraph/hugegraph-server/#31-use-docker-container-convenient-for-testdev>doc</a>。</p></li><li><p>配置 uv 环境，使用官方安装器安装 uv，其他安装方法请参见 <a href=https://docs.astral.sh/uv/configuration/installer/>uv 文档</a>。
    <code>bash     # 如果遇到网络问题，可以尝试使用 pipx 或 pip 安装 uv，详情请参阅 uv 文档     curl -LsSf [https://astral.sh/uv/install.sh](https://astral.sh/uv/install.sh) | sh  - # 安装最新版本，如 0.7.3+    </code></p></li><li><p>克隆本项目
    <code>bash     git clone [https://github.com/apache/incubator-hugegraph-ai.git](https://github.com/apache/incubator-hugegraph-ai.git)    </code></p></li><li><p>配置依赖环境
    <code>bash     cd incubator-hugegraph-ai/hugegraph-llm     uv venv && source .venv/bin/activate     uv pip install -e .    </code>  
    如果由于网络问题导致依赖下载失败或过慢，建议修改 <code>hugegraph-llm/pyproject.toml</code>。</p></li><li><p>启动 <strong>Graph RAG</strong> 的 Gradio 交互式演示，运行以下命令，然后在浏览器中打开 http://127.0.0.1:8001。
    <code>bash     python -m hugegraph_llm.demo.rag_demo.app  # 等同于 "uv run xxx"    </code>
    默认主机是 <code>0.0.0.0</code>，端口是 <code>8001</code>。您可以通过传递命令行参数 <code>--host</code> 和 <code>--port</code> 来更改它们。  
    <code>bash     python -m hugegraph_llm.demo.rag_demo.app --host 127.0.0.1 --port 18001    </code>
   </p></li><li><p>运行 Web 演示后，将在路径 <code>hugegraph-llm/.env</code> 下自动生成配置文件 <code>.env</code>。此外，还将在路径 <code>hugegraph-llm/src/hugegraph_llm/resources/demo/config_prompt.yaml</code> 下生成一个与提示（prompt）相关的配置文件 <code>config_prompt.yaml</code>。
    您可以在网页上修改内容，触发相应功能后，更改将自动保存到配置文件中。您也可以直接修改文件而无需重启 Web 应用；刷新页面即可加载您的最新更改。
    (可选) 要重新生成配置文件，您可以使用 <code>config.generate</code> 并加上 <code>-u</code> 或 <code>--update</code> 参数。  
    <code>bash     python -m hugegraph_llm.config.generate --update    </code>
    注意：<code>Litellm</code> 支持多个 LLM 提供商，请参阅 <a href=https://docs.litellm.ai/docs/providers>litellm.ai</a> 进行配置。</p></li><li><p>(<strong>可选</strong>) 您可以使用
    <a href=/docs/quickstart/toolchain/hugegraph-hubble/#21-use-docker-convenient-for-testdev>hugegraph-hubble</a>
    来访问图数据，可以通过 <a href=https://hub.docker.com/r/hugegraph/hubble>Docker/Docker-Compose</a>
    运行它以获取指导。(Hubble 是一个图分析仪表盘，包括数据加载/Schema管理/图遍历/展示功能)。</p></li><li><p>(<strong>可选</strong>) 离线下载 NLTK 停用词  
    <code>bash     python ./hugegraph_llm/operators/common_op/nltk_helper.py    </code></p></li></ol><blockquote><p>[!TIP]  
您也可以参考我们的<a href=https://github.com/apache/incubator-hugegraph-ai/blob/main/hugegraph-llm/quick_start.md>快速入门</a>文档来了解如何使用它以及基本的查询逻辑 🚧</p></blockquote><h2 id=4-示例>4. 示例</h2><h3 id=41-通过-llm-在-hugegraph-中构建知识图谱>4.1 通过 LLM 在 HugeGraph 中构建知识图谱</h3><h4 id=411-通过-gradio-交互界面构建知识图谱>4.1.1 通过 Gradio 交互界面构建知识图谱</h4><p><strong>参数说明：</strong>  </p><ul><li>Docs（文档）:
  - text: 从纯文本构建 RAG 索引
  - file: 上传文件，文件应为 <u>.txt</u> 或 <u>.docx</u> (可同时选择多个文件)</li><li><a href=https://hugegraph.apache.org/docs/clients/restful-api/schema/>Schema</a> (模式): (除<strong>两种类型</strong>外)
  - 用户自定义 Schema (JSON 格式, 遵循此<a href=https://github.com/apache/incubator-hugegraph-ai/blob/aff3bbe25fa91c3414947a196131be812c20ef11/hugegraph-llm/src/hugegraph_llm/config/config_data.py#L125>模板</a>进行修改)
  - 指定 HugeGraph 图实例的名称，它将自动从中获取 Schema (例如 <strong>&ldquo;hugegraph&rdquo;</strong>)</li><li>Graph extract head (图谱抽取提示头): 用户自定义的图谱抽取提示</li><li>如果已存在图数据，您应点击 &ldquo;<strong>Rebuild vid Index</strong>&rdquo; (重建顶点ID索引) 来更新索引</li></ul><p><img src=https://hugegraph.apache.org/docs/images/gradio-kg.png alt=gradio-配置></p><h4 id=412-通过代码构建知识图谱>4.1.2 通过代码构建知识图谱</h4><p><code>KgBuilder</code> 类用于构建知识图谱。以下是简要使用指南：</p><ol><li><strong>初始化</strong>: <code>KgBuilder</code> 类使用一个语言模型的实例进行初始化。该实例可以从 <code>LLMs</code> 类中获取。
    初始化 LLMs 实例，获取 LLM，然后为图谱构建创建一个任务实例 <code>KgBuilder</code>。<code>KgBuilder</code> 定义了多个算子，用户可以根据需要自由组合它们。(提示: <code>print_result()</code> 可以在控制台中打印每一步的结果，而不影响整体执行逻辑)</li></ol><p>    <code>python     from hugegraph_llm.models.llms.init_llm import LLMs     from hugegraph_llm.operators.kg_construction_task import KgBuilder         TEXT = ""     builder = KgBuilder(LLMs().get_chat_llm())     (         builder         .import_schema(from_hugegraph="talent_graph").print_result()         .chunk_split(TEXT).print_result()         .extract_info(extract_type="property_graph").print_result()         .commit_to_hugegraph()         .run()     )    </code>
    <img src=https://hugegraph.apache.org/docs/images/kg-uml.png alt=gradio-配置-uml>
2. <strong>导入 Schema</strong>: <code>import_schema</code> 方法用于从一个来源导入 Schema。来源可以是一个 HugeGraph 实例、一个用户定义的 Schema 或一个抽取结果。可以链接 <code>print_result</code> 方法来打印结果。
    <code>python     # 从 HugeGraph 实例导入 Schema     builder.import_schema(from_hugegraph="xxx").print_result()     # 从抽取结果导入 Schema     builder.import_schema(from_extraction="xxx").print_result()     # 从用户定义的 Schema 导入     builder.import_schema(from_user_defined="xxx").print_result()    </code>
3. <strong>分块切分</strong>: <code>chunk_split</code> 方法用于将输入文本切分成块。文本应作为字符串参数传递给该方法。
    <code>python     # 将输入文本切分成文档     builder.chunk_split(TEXT, split_type="document").print_result()     # 将输入文本切分成段落     builder.chunk_split(TEXT, split_type="paragraph").print_result()     # 将输入文本切分成句子     builder.chunk_split(TEXT, split_type="sentence").print_result()    </code>
4. <strong>提取信息</strong>: <code>extract_info</code> 方法用于从文本中提取信息。文本应作为字符串参数传递给该方法。
    <code>python     TEXT = "Meet Sarah, a 30-year-old attorney, and her roommate, James, whom she's shared a home with since 2010."     # 从输入文本中提取属性图     builder.extract_info(extract_type="property_graph").print_result()     # 从输入文本中提取三元组     builder.extract_info(extract_type="property_graph").print_result()    </code>
5. <strong>提交到 HugeGraph</strong>: <code>commit_to_hugegraph</code> 方法用于将构建的知识图谱提交到一个 HugeGraph 实例。
    <code>python     builder.commit_to_hugegraph().print_result()    </code>
6. <strong>运行</strong>: <code>run</code> 方法用于执行链式操作。
    <code>python     builder.run()    </code>
    <code>KgBuilder</code> 类的方法可以链接在一起以执行一系列操作。</p><h3 id=42-基于-hugegraph-的检索增强生成-rag>4.2 基于 HugeGraph 的检索增强生成 (RAG)</h3><p><code>RAGPipeline</code> 类用于将 HugeGraph 与大语言模型集成，以提供检索增强生成的能力。
以下是简要使用指南：</p><ol><li><strong>提取关键词</strong>: 提取关键词并扩展同义词。
    <code>python     from hugegraph_llm.operators.graph_rag_task import RAGPipeline     graph_rag = RAGPipeline()     graph_rag.extract_keywords(text="告诉我关于 Al Pacino 的事情。").print_result()    </code></li><li><strong>从关键词匹配顶点ID</strong>: 在图中用关键词匹配节点。
    <code>python     graph_rag.keywords_to_vid().print_result()    </code></li><li><strong>查询图以进行 RAG</strong>: 从 HugeGraph 中检索相应的关键词及其多跳关联关系。
     <code>python      graph_rag.query_graphdb(max_deep=2, max_graph_items=30).print_result()      </code></li><li><strong>重排搜索结果</strong>: 根据问题和结果之间的相似度对搜索结果进行重排序。
     <code>python      graph_rag.merge_dedup_rerank().print_result()      </code></li><li><strong>综合答案</strong>: 总结结果并组织语言来回答问题。
    <code>python     graph_rag.synthesize_answer(vector_only_answer=False, graph_only_answer=True).print_result()    </code></li><li><strong>运行</strong>: <code>run</code> 方法用于执行上述操作。
    <code>python     graph_rag.run(verbose=True)    </code></li></ol></div></div><div class=td-content style=page-break-before:always><h1 id=pg-bb10fc095f5061d789104547f7246a67>1 - GraphRAG UI Details</h1><blockquote><p>接续<a href=../>主文档</a>介绍基础 UI 功能及详情，欢迎随时更新和改进，谢谢</p></blockquote><h1 id=1-项目核心逻辑>1. 项目核心逻辑</h1><h2 id=构建-rag-索引职责>构建 RAG 索引职责：</h2><ul><li>文本分割和向量化</li><li>从文本中提取图（构建知识图谱）并对顶点进行向量化</li></ul><h2 id=graphrag-和用户功能职责>(Graph)RAG 和用户功能职责：</h2><ul><li>根据查询从构建的知识图谱和向量数据库中检索相关内容，用于补充提示词。</li></ul><h1 id=2-处理流程构建-rag-索引>2. （处理流程）构建 RAG 索引</h1><p>从文本构建知识图谱、分块向量和图顶点向量。</p><p><img src=https://github.com/user-attachments/assets/f3366d46-2e31-4638-94c4-7214951ef77a alt=image></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>graph TD;
</span></span><span style=display:flex><span>    A[原始文本] --&gt; B[文本分割]
</span></span><span style=display:flex><span>    B --&gt; C[向量化]
</span></span><span style=display:flex><span>    C --&gt; D[存储到向量数据库]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    A --&gt; F[文本分割]
</span></span><span style=display:flex><span>    F --&gt; G[LLM 基于 schema 和分割后的文本提取图]
</span></span><span style=display:flex><span>    G --&gt; H[将图存储到图数据库，\n自动对顶点进行向量化\n并存储到向量数据库]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    I[从图数据库检索顶点] --&gt; J[对顶点进行向量化并存储到向量数据库\n注意：增量更新]
</span></span></code></pre></div><h3 id=四个输入字段>四个输入字段：</h3><ul><li><strong>文档：</strong> 输入文本</li><li><strong>Schema：</strong> 图的 schema，可以以 JSON 格式的 schema 提供，或提供图名称（如果数据库中已存在）。</li><li><strong>图提取提示词头部：</strong> 提示词的头部</li><li><strong>输出：</strong> 显示结果</li></ul><h3 id=按钮>按钮：</h3><ul><li><p><strong>获取 RAG 信息</strong></p><ul><li><strong>获取向量索引信息：</strong> 检索向量索引信息</li><li><strong>获取图索引信息：</strong> 检索图索引信息</li></ul></li><li><p><strong>清除 RAG 数据</strong></p><ul><li><strong>清除分块向量索引：</strong> 清除分块向量</li><li><strong>清除图顶点向量索引：</strong> 清除图顶点向量</li><li><strong>清除图数据：</strong> 清除图数据</li></ul></li><li><p><strong>导入到向量：</strong> 将文档中的文本转换为向量（需要先对文本进行分块，然后将分块转换为向量）</p></li><li><p><strong>提取图数据 (1)：</strong> 基于 Schema，使用图提取提示词头部和分块内容作为提示词，从文档中提取图数据</p></li><li><p><strong>加载到图数据库 (2)：</strong> 将提取的图数据存储到数据库（自动调用更新顶点嵌入以将向量存储到向量数据库）</p></li><li><p><strong>更新顶点嵌入：</strong> 将图顶点转换为向量</p></li></ul><h3 id=执行流程>执行流程：</h3><ol><li>在<strong>文档</strong>字段中输入文本。</li><li>点击<strong>导入到向量</strong>按钮，对文本进行分割和向量化，存储到向量数据库。</li><li>在 Schema 字段中输入图的 <strong>Schema</strong>。</li><li>点击<strong>提取图数据 (1)</strong> 按钮，将文本提取为图。</li><li>点击<strong>加载到图数据库 (2)</strong> 按钮，将提取的图存储到图数据库（这会自动调用<strong>更新顶点嵌入</strong>以将向量存储到向量数据库）。</li><li>点击<strong>更新顶点嵌入</strong>按钮，将图顶点向量化并存储到向量数据库。</li></ol><h1 id=3-处理流程graphrag-和用户功能>3. （处理流程）(Graph)RAG 和用户功能</h1><p>前一个模块中的<strong>导入到向量</strong>按钮将文本（分块）转换为向量，<strong>更新顶点嵌入</strong>按钮将图顶点转换为向量。这些向量分别存储，用于在本模块中补充查询（答案生成）的上下文。换句话说，前一个模块为 RAG 准备数据（向量化），而本模块执行 RAG。</p><p>本模块包含两个部分：</p><ul><li><strong>HugeGraph RAG 查询</strong></li><li><strong>（批量）回测</strong></li></ul><p>第一部分处理单个查询，第二部分同时处理多个查询。以下是第一部分的说明。</p><p><img src=https://github.com/user-attachments/assets/33698062-e46b-4757-8b5e-93e8f10eae65 alt=image></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>graph TD;
</span></span><span style=display:flex><span>    A[问题] --&gt; B[将问题向量化并在向量数据库中搜索最相似的分块]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    A --&gt; F[使用 LLM 提取关键词]
</span></span><span style=display:flex><span>    F --&gt; G[在图数据库中使用关键词精确匹配顶点；\n在向量数据库中执行模糊匹配（图顶点）]
</span></span><span style=display:flex><span>    G --&gt; H[使用匹配的顶点和查询通过 LLM 生成 Gremlin 查询]
</span></span><span style=display:flex><span>    H --&gt; I[执行 Gremlin 查询；如果成功则完成；如果失败则回退到 BFS]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    B --&gt; J[对结果排序]
</span></span><span style=display:flex><span>    I --&gt; J
</span></span><span style=display:flex><span>    J --&gt; K[生成答案]
</span></span></code></pre></div><h3 id=输入字段>输入字段：</h3><ul><li><strong>问题：</strong> 输入查询</li><li><strong>查询提示词：</strong> 用于向 LLM 提出最终问题的提示词模板</li><li><strong>关键词提取提示词：</strong> 用于从问题中提取关键词的提示词模板</li><li><strong>模板数量：</strong> &lt; 0 表示禁用 text2gql；= 0 表示不使用模板（零样本）；> 0 表示使用指定数量的模板</li></ul><h3 id=查询范围选择>查询范围选择：</h3><ul><li><strong>基础 LLM 答案：</strong> 不使用 RAG 功能</li><li><strong>仅向量答案：</strong> 仅使用基于向量的检索（在向量数据库中查询分块向量）</li><li><strong>仅图答案：</strong> 仅使用基于图的检索（在向量数据库中查询图顶点向量和图数据库）</li><li><strong>图-向量答案：</strong> 同时使用基于图和基于向量的检索</li></ul><p><img src=https://github.com/user-attachments/assets/26641e09-249f-4b3a-8013-16dc9383d333 alt=image></p><h3 id=执行流程-1>执行流程：</h3><h4 id=仅图答案><strong>仅图答案：</strong></h4><ul><li>使用<strong>关键词提取提示词</strong>从<strong>问题</strong>中提取关键词。</li></ul><p><img src=https://github.com/user-attachments/assets/b49e269f-eaec-40b1-8d8f-9e409821d75d alt=image></p><ul><li><p>使用提取的关键词：</p><ul><li>首先，在图数据库中进行精确匹配。</li><li>如果未找到匹配，在向量数据库（图顶点向量）中进行模糊匹配以检索相关顶点。</li></ul></li><li><p><strong>text2gql：</strong> 调用 text2gql 相关接口，使用匹配的顶点作为实体，将<strong>问题</strong>转换为 Gremlin 查询并在图数据库中执行。</p></li><li><p><strong>BFS：</strong> 如果 text2gql 失败（LLM 生成的查询可能无效），回退到使用预定义的<strong>Gremlin 查询模板</strong>执行图查询（本质上是 BFS 遍历）。</p></li></ul><h4 id=仅向量答案><strong>仅向量答案：</strong></h4><ul><li>将<strong>查询</strong>转换为向量。</li><li>在向量数据库的<strong>分块向量</strong>数据集中搜索最相似的内容。</li></ul><h4 id=排序和答案生成><strong>排序和答案生成：</strong></h4><ul><li>执行检索后，对搜索结果进行排序以构建最终的<strong>提示词</strong>。</li><li>基于不同的提示词配置生成答案，并在不同的输出字段中显示：<ul><li><strong>基础 LLM 答案</strong></li><li><strong>仅向量答案</strong></li><li><strong>仅图答案</strong></li><li><strong>图-向量答案</strong></li></ul></li></ul><p><img src=https://github.com/user-attachments/assets/7d4496a3-d44c-4491-9463-8e93595dfa45 alt=image></p><h1 id=4-处理流程text2gremlin>4. （处理流程）Text2Gremlin</h1><p>将自然语言查询转换为 Gremlin 查询。</p><p>本模块包含两个部分：</p><ul><li><strong>构建向量模板索引（可选）：</strong> 将示例文件中的查询/gremlin 对进行向量化并存储到向量数据库中，用于生成 Gremlin 查询时参考。</li><li><strong>自然语言转 Gremlin：</strong> 将自然语言查询转换为 Gremlin 查询。</li></ul><p>第一部分较为简单，因此重点介绍第二部分。</p><p><img src=https://github.com/user-attachments/assets/fc678369-261d-49ea-a289-1ca6ade5ca55 alt=image></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>graph TD;
</span></span><span style=display:flex><span>    A[Gremlin 对文件] --&gt; C[向量化查询]
</span></span><span style=display:flex><span>    C --&gt; D[存储到向量数据库]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    F[自然语言查询] --&gt; G[在向量数据库中搜索最相似的查询\n（如果向量数据库中不存在 Gremlin 对，\n将自动使用默认文件进行向量化）\n并检索对应的 Gremlin]
</span></span><span style=display:flex><span>    G --&gt; H[将匹配的对添加到提示词中\n并使用 LLM 生成与自然语言查询\n对应的 Gremlin]
</span></span></code></pre></div><h3 id=第二部分的输入字段>第二部分的输入字段：</h3><ul><li><strong>自然语言查询：</strong> 输入要转换为 Gremlin 的自然语言文本。</li></ul><p><img src=https://github.com/user-attachments/assets/d2a72f45-488c-4499-968b-a11816655ba0 alt=image></p><ul><li><strong>Schema：</strong> 输入图 schema。</li></ul><h3 id=执行流程-2>执行流程：</h3><ol><li>在<strong>自然语言查询</strong>字段中输入<strong>查询</strong>（自然语言）。</li><li>在<strong>Schema</strong>字段中输入<strong>图 schema</strong>。</li><li>点击<strong>Text2Gremlin</strong>按钮，执行以下逻辑：<ol><li>将<strong>查询</strong>转换为向量。</li><li>构建<strong>提示词</strong>：<ul><li>检索<strong>图 schema</strong>。</li><li>在向量数据库中查询示例向量，检索与输入查询相似的查询-gremlin 对（如果向量数据库中缺少示例，将自动使用<strong>resources</strong>文件夹中的示例进行初始化）。</li></ul></li></ol></li></ol><p><img src=https://github.com/user-attachments/assets/fd150f87-27f8-48e5-8a55-319ec039b7e0 alt=image></p><pre><code>  - 使用构建的提示词生成 Gremlin 查询。
</code></pre><h1 id=5-图工具>5. 图工具</h1><p>输入 Gremlin 查询以执行相应操作。</p></div></main></div></div><footer class="bg-dark py-3 row d-print-none"><div class=footer-container><div class="row bg-dark"><div class=col-1></div><div class="col-4 text-center container-center"><div class=footer-row><a href=https://incubator.apache.org/><div class=footer-apache-logo><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 473.26 110.22"><defs><style>.cls-1,.cls-2{fill:#fff}.cls-1{fill-rule:evenodd}</style></defs><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><polygon class="cls-1" points="445.81 13.29 467.03 13.29 467.03 15.29 448.03 15.29 448.03 27.09 465.11 27.09 465.11 29.09 448.03 29.09 448.03 41.1 467.24 41.1 467.24 43.11 445.81 43.11 445.81 13.29"/><polygon class="cls-1" points="377.65 13.29 379.86 13.29 379.86 27.13 398.95 27.13 398.95 13.29 401.16 13.29 401.16 43.11 398.95 43.11 398.95 29.13 379.86 29.13 379.86 43.11 377.65 43.11 377.65 13.29"/><path class="cls-1" d="M323.93 43.62a14.55 14.55.0 01-10.63-4.45 14.92 14.92.0 01-3.09-4.88 16.21 16.21.0 01-1.11-6V28.2a15.89 15.89.0 014.24-10.89A14.42 14.42.0 01324 12.78a17.34 17.34.0 013.62.34 14 14 0 013 1 15.6 15.6.0 012.6 1.51 23.56 23.56.0 012.36 1.94L334 19.17a24 24 0 00-2-1.75A12.58 12.58.0 00329.7 16 13.11 13.11.0 00324 14.78a12.11 12.11.0 00-9 3.85 13.55 13.55.0 00-2.64 4.24 14.15 14.15.0 00-1 5.24v.09a14.1 14.1.0 001 5.26 13.67 13.67.0 002.67 4.26 12.2 12.2.0 004 2.85 11.83 11.83.0 005 1 12.39 12.39.0 005.63-1.2A17.89 17.89.0 00334.28 37l1.49 1.45a26.6 26.6.0 01-2.45 2.11 15 15 0 01-2.68 1.64 14.81 14.81.0 01-3.09 1.07A16.42 16.42.0 01323.93 43.62z"/><path class="cls-1" d="M252.32 13.07h2.13l13.89 30h-2.43l-3.79-8.35h-17.6l-3.79 8.35h-2.3l13.89-30zm8.86 19.69-7.84-17.26-7.88 17.26z"/><path class="cls-1" d="M176.74 13.29h10.82a15.11 15.11.0 014.5.62 10.36 10.36.0 013.49 1.78 8.21 8.21.0 012.28 2.86 8.78 8.78.0 01.81 3.85v.09a8.56 8.56.0 01-3.47 7.11 11.22 11.22.0 01-3.71 1.79A16.16 16.16.0 01187 32h-8V43.11h-2.22V13.29zM187.14 30a13.21 13.21.0 003.79-.51A8.65 8.65.0 00193.85 28a6.76 6.76.0 001.89-2.33 6.66 6.66.0 00.69-3v-.09a7 7 0 00-.67-3.15 6.12 6.12.0 00-1.85-2.25 8.68 8.68.0 00-2.85-1.37 13.6 13.6.0 00-3.67-.47H179V30z"/><path class="cls-1" d="M118.64 13.07h2.13l13.88 30h-2.42l-3.8-8.35H110.84l-3.79 8.35h-2.3l13.89-30zm8.86 19.69-7.84-17.26-7.88 17.26z"/><path class="cls-1" d="M471.26 70.85q0 10.83-9.44 13.64l11.44 15.88h-9.38L453.44 85.68h-9.7v14.69h-7.38V56.66h16.27q10 0 14.32 3.37t4.31 10.82zM452.94 79q6.26.0 8.5-1.93c1.5-1.3 2.25-3.37 2.25-6.23s-.77-4.81-2.31-5.88-4.29-1.59-8.25-1.59h-9.39V79z"/><path class="cls-1" d="M422.13 94.34a24 24 0 01-32.77.0 21.65 21.65.0 01-6.63-16.14 21.61 21.61.0 016.63-16.13 24 24 0 0132.77.0 21.61 21.61.0 016.63 16.13 21.65 21.65.0 01-6.63 16.14zM416.72 67a15.32 15.32.0 00-22 0 16.33 16.33.0 000 22.45 15.32 15.32.0 0022 0 16.33 16.33.0 000-22.45z"/><polygon class="cls-1" points="367.18 63.41 367.18 100.37 359.8 100.37 359.8 63.41 346.54 63.41 346.54 56.66 380.44 56.66 380.44 63.41 367.18 63.41"/><path class="cls-1" d="M315.61 90.43l-4.38 9.94h-7.88l19.27-43.71h7.88l19.26 43.71h-7.88l-4.38-9.94zm18.89-6.82-7.94-18-7.95 18z"/><path class="cls-1" d="M286.62 100.37H267.48V56.66h17a24.47 24.47.0 017.66 1.06 10.56 10.56.0 014.79 2.88 11.17 11.17.0 013 7.63c0 3.42-1.09 6-3.25 7.63A14.58 14.58.0 01295.06 77q-.44.22-1.56.72a11.54 11.54.0 016.5 3.61 10.23 10.23.0 012.41 6.91 11.76 11.76.0 01-3.13 8.07q-3.69 4.06-12.63 4.06zm-11.76-6.81h11.57a12.25 12.25.0 006.22-1.29c1.44-.85 2.16-2.47 2.16-4.84q0-5.82-9.32-5.82H274.86v12zm0-18.77h9.38q8 0 8-5.44a5.15 5.15.0 00-1.94-4.5c-1.29-.92-3.3-1.38-6-1.38h-9.44V74.79z"/><path class="cls-1" d="M231 90.37a11.19 11.19.0 0016.26.0q3-3.51 3-9.51V56.66h7.38V81.17q0 9.45-5.19 14.54a19.94 19.94.0 01-26.64.0q-5.19-5.08-5.19-14.54V56.66H228v24.2Q228 86.86 231 90.37z"/><path class="cls-1" d="M196.8 93.68a15.48 15.48.0 006.56-1.28 22.58 22.58.0 005.76-4.1l4.75 4.88A21.87 21.87.0 01197 100.87a22.57 22.57.0 01-16.45-6.38A21.58 21.58.0 01174 78.36a21.78 21.78.0 016.66-16.26q6.66-6.51 16.83-6.51a22 22 0 0117 7.51l-4.69 5.13A20.41 20.41.0 00203.9 64a16.46 16.46.0 00-6.54-1.19 15.54 15.54.0 00-11.13 4.28 14.48 14.48.0 00-4.51 11 15.12 15.12.0 004.48 11.13A14.48 14.48.0 00196.8 93.68z"/><polygon class="cls-1" points="159.05 56.66 166.43 56.66 166.43 100.37 158.42 100.37 133.66 68.48 133.66 100.37 126.28 100.37 126.28 56.66 133.66 56.66 159.05 89.3 159.05 56.66"/><rect class="cls-2" x="108.48" y="56.66" width="7.38" height="43.72"/><path class="cls-1" d="M44.92 15.1c0-.32.0-.64.0-1l.57 1zM33.16 49.33a49.36 49.36.0 00-5.89 20c-.44 6.17.22 11.49 2 16 .25.61.49 1.17.72 1.69q-2.13-1.52-4.07-3.15c-.11-.09-.19-.12-.24-.11a32.87 32.87.0 006.36 7.39c.39.34 1 .5 1.2 1 .46 1.45-.79 14.4 3.22 17.42 2.55 1.92 13.82-.49 17.3-1.62C71.92 102 86 85.26 83.9 61.11 81.61 34.62 64.16 7.68 46.75 1.2 42-.55 41-.39 36.11 1.7 19.13 9 2.45 35.25.21 61.11-1.95 86 13 103 31.9 108.36l1.48.41a19.49 19.49.0 01-1.2-3.36C12.38 99.52 1.31 82 3.1 61.36 4.81 41.65 18 12.6 37.25 4.37c4-1.72 4.41-2 8.48-.44C65.48 11.27 79.27 41.32 81 61.36 82.86 82.78 70.78 100.81 49.89 106a39.89 39.89.0 01-5.62 1c-5.42.55-7.3 1.5-8.29-4.13-2.19-12.44-.54-34.94 4.87-43.57a9.4 9.4.0 01-.4 1.5c-.18.44-.31.71-.36.85-3.24 7.42-5.05 28.95-3.5 33-.45-1.46.35-4.55 1.51-5.18l.66-.47c3.63-2.61 6-6.71 8.59-11.91.0-.07-.13-.07-.25.0a33.72 33.72.0 01-3.78 2.76A43.06 43.06.0 0051.06 68c-.06-.09-.16-.07-.31.0-.87.79-1.76 1.53-2.67 2.23 3.71-6.72 7-14.49 7.32-23.38a38.61 38.61.0 00-3.16-16.59c-.78-1.81-1.88-4-3.29-6.53C46.86 20 45.73 18 45.55 17.7c.1 8.15-1.34 14.78-4.31 19.84a60.7 60.7.0 01-4.09 5.86 46.12 46.12.0 00-3.99 5.93z"/></g></g></svg></div></a><ul class=footer-link><li><a class=white href=https://www.apache.org>Foundation</a></li><li><a class=white href=https://www.apache.org/licenses/>License</a></li><li><a class=white href=https://hugegraph.apache.org/docs/guides/security>Security</a></li><li><a class=white href=https://www.apache.org/events/current-event>Events</a></li><li><a class=white href=https://www.apache.org/foundation/sponsorship.html>Sponsorship</a></li><li><a class=white href=https://www.apache.org/foundation/thanks.html>Thanks</a></li><li><a class=white href=https://privacy.apache.org/policies/privacy-policy-public.html target=_blank>Privacy</a></li></ul></div></div><div class="col-6 text-white text-center container-center"><p>Apache HugeGraph is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p><p>Copyright &copy; 2025 The Apache Software Foundation, Licensed under the <a class=white href=https://www.apache.org/licenses/LICENSE-2.0>Apache License Version 2.0</a><br>Apache, the names of Apache projects, and the feather logo are either registered trademarks or trademarks of the Apache Software Foundation in the United States and/or other countries.</p></div><div class=col-1></div></div></div></footer></div><script src=/js/popper.min.js></script>
<script src=/js/bootstrap.min.js></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.aa9f4c5dae6a98b2c46277f4c56f1673a2b000d1756ce4ffae93784cab25e6d5.js integrity="sha256-qp9MXa5qmLLEYnf0xW8Wc6KwANF1bOT/rpN4TKsl5tU=" crossorigin=anonymous></script>
<script src=/js/prism.js></script></body></html>