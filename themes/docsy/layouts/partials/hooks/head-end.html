{{ with .Site.Params.algolia_docsearch }}
<!-- stylesheet for algolia docsearch -->
{{ end }}

{{ if .Site.Params.mermaid.enable }}
<script>
document.addEventListener('DOMContentLoaded', function() {
    var codeBlocks = document.querySelectorAll('pre code.language-mermaid, code.language-mermaid, pre code.language-fallback, code.language-fallback');
    var mermaidBlocks = [];
    
    codeBlocks.forEach(function(block) {
        var content = block.textContent.trim();
        if (content.match(/^(graph|flowchart|sequenceDiagram|classDiagram|pie|gitgraph|erDiagram|journey|gantt|stateDiagram|mindmap|timeline|quadrantChart)/m) ||
            content.includes('-->') || content.includes('->') || content.includes('style ') || content.includes('fill:')) {
            mermaidBlocks.push(block);
        }
    });
    
    if (mermaidBlocks.length > 0) {
        mermaidBlocks.forEach(function(block) {
            var mermaidDiv = document.createElement('div');
            mermaidDiv.className = 'mermaid';
            mermaidDiv.textContent = block.textContent.trim();
            
            var container = block.closest('pre') || block.parentElement;
            container.parentNode.replaceChild(mermaidDiv, container);
        });
        
        mermaid.initialize({
            startOnLoad: true,
            theme: '{{ .Site.Params.mermaid.theme | default "default" }}',
            securityLevel: 'loose'
        });
    }
});
</script>
{{ end }}